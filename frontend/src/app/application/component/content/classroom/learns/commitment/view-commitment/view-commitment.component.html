<div class="container" style="height: 100%">
  <div class="list">
    <div *ngIf="!this.commitments.length" class="no-data">
      <div class="icon">
        <mat-icon>info_outlined</mat-icon>
      </div>
      <div class="info">
        Nincsenek vállalt feladatok
      </div>
    </div>
    <div *ngIf="this.commitments.length && this.tasks.size">
      <div *ngFor="let commitment of this.commitments" class="item" (click)="view(commitment)"
           [ngStyle]="{'background-color': commitment.taskId === selectedCommitment.taskId ? ' #e6f2f8': ''}">
        <div>{{this.tasks.get(commitment.taskId)!.title}}</div>
        <div>{{this.tasks.get(commitment.taskId)!.points}} pont</div>
        <div *ngIf="this.tasks.get(commitment.taskId)!.teamwork">
          <mat-icon>groups</mat-icon>
        </div>
      </div>
    </div>
  </div>
  <div class="view">
    <div *ngIf="!selectedCommitment.id" class="no-data">
      <div class="icon">
        <mat-icon>info_outlined</mat-icon>
      </div>
      <div class="info">
        Válassz egy feladatot
      </div>
    </div>
    <div *ngIf="selectedCommitment.id">
      <div class="title">{{this.tasks.get(selectedCommitment.taskId)!.title}}</div>
      <div>{{this.tasks.get(selectedCommitment.taskId)!.summary}}</div>
      <div>
        <div *ngIf="this.tasks.get(selectedCommitment.taskId)!.teamwork" class="team">
          <mat-icon>groups</mat-icon>
          <mat-chip-set>
            <mat-chip *ngFor="let username of getUsers(this.tasks.get(selectedCommitment.taskId)!.id!)" disableRipple>{{username}}</mat-chip>
          </mat-chip-set>
        </div>
      </div>
      <div class="label">Feladatleírás:</div>
      <div>{{this.tasks.get(selectedCommitment.taskId)!.description}}</div>
      <div *ngIf="links.length || files.length">
        <div class="label">Csatolmányok:</div>
        <div *ngFor="let link of links"><a href="{{link.path}}" target="_blank">{{link.path}}</a></div>
        <div *ngFor="let fileAttachment of files" (click)="downloadFile(fileAttachment.fileId!, fileAttachment.path)">
          <mat-icon>description</mat-icon>{{fileAttachment.path}}
        </div>
      </div>
      <div class="link-container" *ngIf="this.tasks.get(this.selectedCommitment.taskId)!.submit">
        <div class="attachment">
          <div class="header">
            <div class="label">
              Beadott fájlok
            </div>
            <button mat-icon-button matTooltip="Fájlok feltöltése" matTooltipPosition="above" (click)="checkUploadFiles()" [disabled]="this.uploadFiles">
              <mat-icon>add</mat-icon>
            </button>
          </div>
          <div *ngFor="let handinByDate of handinsByDate">
            <div>{{handinByDate.date | date:"yyyy.MM.dd HH:mm"}}</div>
            <div *ngFor="let handin of handinByDate.handins" (click)="downloadFile(handin.fileId!, handin.path)">
              <mat-icon>description</mat-icon>{{handin.path}}
            </div>
          </div>
          <div *ngIf="uploadFiles">
            <div>
              <input multiple type="file" [formControl]="handinControl" (change)="fileSelectionChanged($event)">
            </div>
            <button mat-icon-button matTooltip="Mégse" matTooltipPosition="after" (click)="removeFileUpload()" class="link-remove">
              <mat-icon>remove</mat-icon>
            </button>
            <div class="button-container">
              <button mat-raised-button color="primary" class="control" [disabled]="isDisabled()" (click)="save()">Beadás
              </button>
              <button mat-raised-button class="control" mat-dialog-close="true">Mégse</button>
            </div>
          </div>
        </div>
      </div>
      <mat-chip-set>
        <mat-chip *ngFor="let badge of this.badges" [matTooltip]="badge.tooltip" disableRipple>
          <mat-icon style="font-size: 20px">{{badge.icon}}</mat-icon>
        </mat-chip>
      </mat-chip-set>
      <div class="label">Eredmény:</div>
      <div><span class="result">{{selectedCommitment.points}}</span>
        / {{this.tasks.get(selectedCommitment.taskId)!.points}} pont
      </div>
    </div>
  </div>
</div>
